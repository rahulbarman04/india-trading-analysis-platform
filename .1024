version: "1.0"
mode: development

services:
  # FastAPI Backend - Trading Analysis Platform
  backend:
    command: |
      cd backend && 
      pip install -r requirements.txt &&
      uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
    port: 8000
    tags: [api, backend]

  # Node.js Streaming Service - Real-time Data
  streaming:
    command: |
      cd streaming-service &&
      npm install &&
      npm start
    port: 3001
    tags: [streaming, realtime]

  # React Frontend - Trading Dashboard
  frontend:
    command: |
      cd frontend &&
      npm install &&
      npm run dev -- --host 0.0.0.0 --port 5173
    port: 5173
    tags: [frontend, react]

environment:
  # Database Configuration
  DB_HOST: ${POSTGRES_HOST}
  DB_PORT: ${POSTGRES_PORT}
  DB_NAME: ${POSTGRES_DB}
  DB_USER: ${POSTGRES_USER}
  DB_PASSWORD: ${POSTGRES_PASSWORD}
  
  # Redis Configuration
  REDIS_HOST: ${REDIS_HOST}
  REDIS_PORT: ${REDIS_PORT}
  REDIS_PASSWORD: ${REDIS_PASSWORD}
  
  # Application Configuration
  SECRET_KEY: "your-secret-key-for-jwt-tokens"
  ALGORITHM: "HS256"
  ACCESS_TOKEN_EXPIRE_MINUTES: 30
  
  # API Keys (Add your actual API keys here)
  ALPHA_VANTAGE_API_KEY: "demo"
  TWITTER_BEARER_TOKEN: "your-twitter-bearer-token"
  NEWS_API_KEY: "your-news-api-key"

middlewares:
  - name: postgresql
    version: "13"
  - name: redis
    version: "7"